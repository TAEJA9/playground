<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Yí´ë¼ìš°ë“œ CMS ëŒ€ëŸ‰ë“±ë¡ ê°œì²´ ë³€í™˜ê¸°</title>
<link rel="icon" href="favicon.png" type="image/png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@latest/dist/web/static/pretendard.css" />

<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

<style>
  :root {
    --bg:#f8fafc; --fg:#1e293b; --muted:#64748b; --accent:#3b82f6; --card:#ffffff; --line:#e2e8f0;
    --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444;
    --thead:#f1f5f9;
    --input-bg:#ffffff; --input-border:#cbd5e1;
    --header-bg:rgba(255,255,255,0.8);
    --shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
  }

  [data-theme="dark"] {
    --bg:#0f172a; --fg:#f1f5f9; --muted:#94a3b8; --accent:#60a5fa; --card:#1e293b; --line:#334155;
    --ok:#4ade80; --warn:#fbbf24; --danger:#f87171;
    --thead:#334155;
    --input-bg:#0f172a; --input-border:#334155;
    --header-bg:rgba(15,23,42,0.8);
    --shadow:0 10px 15px -3px rgba(0,0,0,0.5);
  }

  * { box-sizing: border-box; }
  body {
    margin:0; background:var(--bg); color:var(--fg);
    font-family:"Pretendard", sans-serif;
    -webkit-font-smoothing:antialiased;
  }

  header {
    padding:16px 24px; border-bottom:1px solid var(--line); background:var(--header-bg);
    position:sticky; top:0; z-index:100; backdrop-filter:blur(12px);
  }
  .header-inner { max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content: space-between; }
  h1 { margin:0; font-size:18px; font-weight: 800; display: flex; align-items: center; gap: 8px; }
  
  .container { max-width:1200px; margin:24px auto; padding:0 20px; display: grid; gap: 24px; }
  
  /* ì˜ì—­ ë†’ì´ ì¼ì¹˜ë¥¼ ìœ„í•´ stretch ì‚¬ìš© */
  .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: stretch; }
  
  .step { 
    background:var(--card); border:1px solid var(--line); border-radius:16px; padding:20px; box-shadow:var(--shadow);
    display: flex; flex-direction: column; /* ë‚´ë¶€ ìš”ì†Œ í™•ì¥ì„ ìœ„í•´ flex ì„¤ì • */
  }
  .step-title { display:flex; align-items:center; gap:10px; margin:0 0 16px; font-size:16px; font-weight: 700; color:var(--accent); }
  .badge {
    width:24px; height:24px; display:inline-flex; align-items:center; justify-content:center;
    background:var(--accent); color:#fff; border-radius:6px; font-weight:800; font-size:12px;
  }

  input[type="text"], select, textarea {
    width:100%; background:var(--input-bg); color:var(--fg);
    border:1px solid var(--input-border); border-radius:10px; padding:10px 12px;
    font-size: 14px; transition: border-color 0.2s;
  }
  input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent); }

  /* 1ë²ˆ ì˜ì—­ textareaê°€ ë‚¨ëŠ” ê³µê°„ì„ ë‹¤ ì±„ìš°ë„ë¡ ì„¤ì • */
  textarea#raw { flex-grow: 1; min-height: 350px; resize:none; font-family: monospace; font-size: 12px; }

  .hint { font-size:12px; color:var(--muted); margin-top:6px; line-height: 1.4; }
  .grid-2 { display:grid; grid-template-columns: 1fr 1fr; gap:16px; flex-grow: 1; }
  
  .col-group { 
    display: flex; flex-direction: column; gap: 10px; 
    border: 1px solid var(--line); padding: 14px; border-radius: 12px; 
    background: rgba(0,0,0,0.02); justify-content: center;
  }
  
  .row { display:flex; gap:10px; align-items:center; }
  button {
    background:var(--accent); color:#ffffff; border:0; border-radius:10px; padding:12px 20px; font-weight:700; cursor:pointer;
    display: inline-flex; align-items: center; justify-content: center; gap: 6px; transition: opacity 0.2s;
  }
  button:hover { opacity: 0.9; }
  button.ghost { background:transparent; color:var(--accent); border:1px solid var(--accent); }
  button.ok { background:var(--ok); }
  button.secondary { background: var(--muted); }

  /* AI Playground ì „ìš© ìŠ¤íƒ€ì¼ */
  button.ai-btn { background: #8b5cf6; color: white; border: none; }
  button.ai-btn:hover { background: #7c3aed; }

  .preview-container { grid-column: span 2; }
  .table-wrapper { overflow-x: auto; border-radius: 12px; border: 1px solid var(--line); min-height: 100px; }
  table { width:100%; border-collapse:collapse; font-size:13px; background: var(--card); }
  th, td { border-bottom:1px solid var(--line); padding:12px; text-align:left; }
  thead th { background:var(--thead); font-weight: 700; color: var(--muted); }

  .appendix { background: color-mix(in srgb, var(--accent) 5%, var(--card)); border: 1px dashed var(--accent); margin-top: 20px; }
  .ps-code { background: #1e1e1e; color: #d4d4d4; padding: 16px; border-radius: 10px; font-family: 'Consolas', monospace; font-size: 13px; position: relative; margin-top: 12px; word-break: break-all; }

  footer { padding:40px 20px; color:var(--muted); text-align:center; font-size: 13px; }

  @media (max-width:980px) { .main-grid { grid-template-columns:1fr; } .preview-container { grid-column: auto; } }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <h1>ğŸ€ Yí´ë¼ìš°ë“œ CMS ê°œì²´ ëŒ€ëŸ‰ë“±ë¡ ê²°ê³¼ ë³€í™˜ê¸°</h1>
    <div class="row">
      <button class="ghost" id="themeBtn">í…Œë§ˆ ì „í™˜</button>
      <button class="ghost" id="btnResetHeader">ì´ˆê¸°í™”</button>
      <button class="ai-btn" id="btnPlayground">AI Playground</button>
    </div>
  </div>
</header>

<main class="container">

  <div class="main-grid">
    <section class="step">
      <h2 class="step-title"><span class="badge">1</span> ê²°ê³¼ ë°ì´í„° ì…ë ¥</h2>
      <textarea id="raw" placeholder="ëŒ€ëŸ‰ë“±ë¡ ê²°ê³¼ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
      <div style="margin-top:12px;">
        <label class="hint">ë ˆì½”ë“œ ë¶„ë¦¬ ê¸°ì¤€</label>
        <select id="recSep" style="margin-top:4px;">
          <option value="newline" selected>ì¤„ë°”ê¿ˆ ê¸°ì¤€</option>
          <option value="number">ë²ˆí˜¸ ê¸°ì¤€ (1;, 2;, ...)</option>
        </select>
      </div>
    </section>

    <section class="step">
      <h2 class="step-title"><span class="badge">2</span> ì¶œë ¥ í˜•ì‹ ì„¤ì •</h2>
      <div style="margin-bottom:16px;">
        <label class="hint">ë§í¬ ê¸°ë³¸ URL</label>
        <input id="baseUrl" type="text" value="https://www.ybmcloud.com/viewer?contentId=" />
      </div>

      <div class="grid-2">
        <div class="col-group">
          <select id="colA" onchange="autoHeader(this, 'headA')">
            <option value="filename_noext" selected>íŒŒì¼ëª…(í™•ì¥ì ì œì™¸)</option>
            <option value="filename_ext">íŒŒì¼ëª…(í™•ì¥ì í¬í•¨)</option>
            <option value="link">ë§í¬(ìë™)</option>
            <option value="content_id">ê°œì²´ID</option>
            <option value="custom">ì§ì ‘ì…ë ¥</option>
          </select>
          <input id="headA" type="text" value="íŒŒì¼ëª…" placeholder="ì—‘ì…€ í—¤ë”ëª…" />
          <input type="text" id="customA" placeholder="ì§ì ‘ ì…ë ¥ë  ê°’" style="display:none;">
        </div>
        
        <div class="col-group">
          <select id="colB" onchange="autoHeader(this, 'headB')">
            <option value="link" selected>ë§í¬(ìë™)</option>
            <option value="filename_noext">íŒŒì¼ëª…(í™•ì¥ì ì œì™¸)</option>
            <option value="content_id">ê°œì²´ID</option>
            <option value="custom">ì§ì ‘ì…ë ¥</option>
          </select>
          <input id="headB" type="text" value="ë§í¬" placeholder="ì—‘ì…€ í—¤ë”ëª…" />
          <input type="text" id="customB" placeholder="ì§ì ‘ ì…ë ¥ë  ê°’" style="display:none;">
        </div>

        <div class="col-group">
          <select id="colC" onchange="autoHeader(this, 'headC')">
            <option value="content_id" selected>ê°œì²´ID</option>
            <option value="link">ë§í¬(ìë™)</option>
            <option value="custom">ì§ì ‘ì…ë ¥</option>
          </select>
          <input id="headC" type="text" value="ê°œì²´ID" placeholder="ì—‘ì…€ í—¤ë”ëª…" />
          <input type="text" id="customC" placeholder="ì§ì ‘ ì…ë ¥ë  ê°’" style="display:none;">
        </div>

        <div class="col-group">
          <select id="colD" onchange="autoHeader(this, 'headD')">
            <option value="empty" selected>ì‚¬ìš© ì•ˆ í•¨</option>
            <option value="status">ë“±ë¡ìƒíƒœ</option>
            <option value="idx">ì¸ë±ìŠ¤</option>
            <option value="custom">ì§ì ‘ì…ë ¥</option>
          </select>
          <input id="headD" type="text" value="" placeholder="ì—‘ì…€ í—¤ë”ëª…(ì„ íƒ)" />
          <input type="text" id="customD" placeholder="ì§ì ‘ ì…ë ¥ë  ê°’" style="display:none;">
        </div>
      </div>
      
      <div style="margin-top:20px; display:flex; gap:8px;">
        <button id="btnPreview" class="secondary" style="flex:1;">ë¯¸ë¦¬ë³´ê¸°</button>
        <button id="btnDownloadXLSX" class="ok" style="flex:2;">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
      </div>
    </section>

    <section class="step preview-container">
      <h2 class="step-title"><span class="badge">3</span> ë³€í™˜ ë¯¸ë¦¬ë³´ê¸° (ìƒìœ„ 20ê°œ)</h2>
      <div id="preview" class="table-wrapper">
        <div style="padding:40px; text-align:center; color:var(--muted);">ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  ë¯¸ë¦¬ë³´ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
      </div>
    </section>

    <section class="step appendix" style="grid-column: span 2;">
      <h2 class="step-title">ğŸ“ ë¶€ë¡: PowerShell ëª…ë ¹ ìƒì„±ê¸°</h2>
      <p class="hint">ë¡œì»¬ í´ë” ë‚´ì˜ íŒŒì¼ëª… ëª©ë¡ì„ í´ë¦½ë³´ë“œë¡œ ë³µì‚¬í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
      
      <div class="row" style="margin-top:15px;">
        <div style="flex:1;">
          <label class="hint">ëŒ€ìƒ í´ë” ê²½ë¡œ (í´ë¦­ ì‹œ ì „ì²´ ì„ íƒ)</label>
          <input type="text" id="psFolder" 
                 placeholder="ì˜ˆ: C:\Users\YBM\ìë£Œí´ë”" 
                 onclick="this.select()" 
                 oninput="updatePS()" />
        </div>
        <button id="btnCopyPS" style="align-self: flex-end;">ëª…ë ¹ì–´ ë³µì‚¬</button>
      </div>

      <div class="ps-code" id="psResult">
        Get-ChildItem "í´ë” ê²½ë¡œë¥¼ ì…ë ¥í•˜ì„¸ìš”" -Recurse -File | Select-Object -ExpandProperty Name | Set-Clipboard
      </div>
    </section>
  </div>

</main>

<footer>
  â“’ Jeongyeon. 2026
</footer>

<script>
  const el = (id)=>document.getElementById(id);
  const themeBtn = el('themeBtn');
  const root = document.documentElement;

  // --- Theme ---
  themeBtn.addEventListener('click', () => {
    const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', next);
    themeBtn.textContent = next === 'dark' ? 'ë¼ì´íŠ¸ ëª¨ë“œ' : 'ë‹¤í¬ ëª¨ë“œ';
  });

  // --- AI Playground ì—°ê²° ---
  el('btnPlayground').addEventListener('click', () => {
    location.href = 'https://taeja9.github.io/playground/';
  });

  // --- Auto Header Logic ---
  function autoHeader(selectEl, targetInputId) {
    const input = el(targetInputId);
    const selectedText = selectEl.options[selectEl.selectedIndex].text;
    
    if (selectEl.value === 'empty') {
      input.value = '';
    } else if (selectEl.value === 'custom') {
      input.value = 'ì»¤ìŠ¤í…€';
    } else {
      input.value = selectedText.split('(')[0];
    }
    
    const customInputId = 'custom' + targetInputId.replace('head', '');
    el(customInputId).style.display = selectEl.value === 'custom' ? 'block' : 'none';
  }

  // --- PowerShell Generator ---
  function updatePS() {
    const path = el('psFolder').value;
    const displayPath = path || "í´ë” ê²½ë¡œë¥¼ ì…ë ¥í•˜ì„¸ìš”";
    const cmd = `Get-ChildItem "${displayPath}" -Recurse -File | Select-Object -ExpandProperty Name | Set-Clipboard`;
    el('psResult').textContent = cmd;
  }

  el('btnCopyPS').addEventListener('click', () => {
    const code = el('psResult').textContent;
    navigator.clipboard.writeText(code).then(() => {
      const btn = el('btnCopyPS');
      const originalText = btn.textContent;
      btn.textContent = "ë³µì‚¬ ì™„ë£Œ!";
      btn.style.background = "var(--ok)";
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = "var(--accent)";
      }, 2000);
    });
  });

  // --- Core Logic ---
  const raw = el('raw'), recSep = el('recSep'), baseUrl = el('baseUrl');
  const headA = el('headA'), headB = el('headB'), headC = el('headC'), headD = el('headD');
  const colA = el('colA'), colB = el('colB'), colC = el('colC'), colD = el('colD');
  const customA = el('customA'), customB = el('customB'), customC = el('customC'), customD = el('customD');

  function parseRows() {
    const text = raw.value.trim();
    if(!text) return [];
    let recs = [];
    if(recSep.value === 'newline') {
      recs = text.split(/\n+/).filter(Boolean);
    } else {
      const re = /(\d+;[\s\S]*?)(?=(?:\s*\d+;)|$)/g;
      let m;
      while ((m = re.exec(text)) !== null) recs.push(m[1].trim());
    }
    
    return recs.map(r => {
      const cells = r.split(';');
      if(cells.length < 4) return null;
      const parts = cells.map(s=>s.trim());
      const filename = parts.pop();
      const content_id = parts.pop();
      const status = parts.pop();
      const idx = parts.pop();
      return { idx, status, content_id, filename };
    }).filter(Boolean);
  }

  function getVal(row, mode, custom) {
    if(!row) return '';
    switch(mode) {
      case 'filename_ext': return row.filename;
      case 'filename_noext': return row.filename.replace(/\.[^/.]+$/, '');
      case 'link': return baseUrl.value + row.content_id;
      case 'content_id': return row.content_id;
      case 'status': return row.status;
      case 'idx': return row.idx;
      case 'custom': return custom.value;
      default: return '';
    }
  }

  function buildData() {
    const rows = parseRows();
    const data = [[headA.value, headB.value, headC.value, headD.value]];
    rows.forEach(r => {
      data.push([
        getVal(r, colA.value, customA),
        getVal(r, colB.value, customB),
        getVal(r, colC.value, customC),
        getVal(r, colD.value, customD)
      ]);
    });
    return data;
  }

  el('btnPreview').addEventListener('click', () => {
    const data = buildData();
    if(data.length <= 1) { el('preview').innerHTML = '<div style="padding:40px; text-align:center; color:var(--muted);">ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>'; return; }
    let html = '<table><thead><tr>' + data[0].map(h=>`<th>${h}</th>`).join('') + '</tr></thead><tbody>';
    data.slice(1, 21).forEach(row => {
      html += '<tr>' + row.map(v=>`<td>${v}</td>`).join('') + '</tr>';
    });
    el('preview').innerHTML = html + '</tbody></table>';
  });

  el('btnDownloadXLSX').addEventListener('click', () => {
    const data = buildData();
    if(data.length <= 1) return alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
    const ws = XLSX.utils.aoa_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Result");
    XLSX.writeFile(wb, "ybm_cms_result.xlsx");
  });

  el('btnResetHeader').addEventListener('click', () => {
    if(confirm('ëª¨ë“  ì„¤ì •ì„ ì´ˆê¸°í™”í• ê¹Œìš”?')) location.reload();
  });
</script>
</body>
</html>

